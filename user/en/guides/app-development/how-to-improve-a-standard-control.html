<!DOCTYPE html>
<!-- Built on Frappe. https://frappe.io/ -->
<html lang="en">
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>How To Improve A Standard Control</title>
	<meta name="generator" content="frappe">
    <link type="text/css" rel="stylesheet" href="https://frappe.github.io/frappe/assets/css/bootstrap.css">
    <link type="text/css" rel="stylesheet" href="https://frappe.github.io/frappe/assets/css/hljs.css">
    <link type="text/css" rel="stylesheet" href="https://frappe.github.io/frappe/assets/css/font-awesome.css">
    <link type="text/css" rel="stylesheet" href="https://frappe.github.io/frappe/assets/css/octicons/octicons.css">
    <link type="text/css" rel="stylesheet" href="https://frappe.github.io/frappe/assets/css/docs.css">

    
	<link rel="shortcut icon"
		href="https://frappe.github.io/frappe/assets/img/favicon.png"
		type="image/x-icon">
	<link rel="icon"
		href="https://frappe.github.io/frappe/assets/img/favicon.png"
		type="image/x-icon">
    

		</head>
<body data-path="user/en/guides/app-development/how-to-improve-a-standard-control">
	<div class="main-section">
		<div>
					<nav class="navbar navbar-default navbar-main" role="navigation">
		<div class="container">
			<div class="navbar-header">
				<a class="navbar-brand ellipsis"
					 href="https://frappe.github.io/frappe//">
					<span><img class="brand-logo" src="https://frappe.github.io/frappe/assets/img/frappe-bird-white.png"> Frappé Framework</img></span>
				</a>
				<div class="dropdown">
					<button class="btn btn-default navbar-toggle" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">
						<i class="octicon octicon-three-bars"></i>
					</button>
					<ul class="dropdown-menu dropdown-menu-right">
<li data-label='<i class="octicon octicon-search"></i>' >
	<a href="/#"
		
		>
	<i class="octicon octicon-search"></i></a></li><li data-label='Tutorials' >
	<a href="https://frappe.github.io/frappe/user"
		
		>
	Tutorials</a></li><li data-label='API' >
	<a href="https://frappe.github.io/frappe/current"
		
		>
	API</a></li><li data-label='Forum' >
	<a href="https://discuss.erpnext.com"
		
		>
	Forum</a></li>

<li class="divider"></li>

<!-- post login tools -->

</ul>
				</div>
			</div>
			<div class="hidden-xs">
				
				<ul class="nav navbar-nav navbar-left">
</ul>
<ul class="nav navbar-nav navbar-right"><li data-label='<i class="octicon octicon-search"></i>' >
	<a href="/#"
		
		>
	<i class="octicon octicon-search"></i></a></li><li data-label='Tutorials' >
	<a href="https://frappe.github.io/frappe/user"
		
		>
	Tutorials</a></li><li data-label='API' >
	<a href="https://frappe.github.io/frappe/current"
		
		>
	API</a></li><li data-label='Forum' >
	<a href="https://discuss.erpnext.com"
		
		>
	Forum</a></li>
	
	
	<!-- post login tools -->

</ul>
				
			</div>
		</div>
	</nav><div class="hero-and-content">
                <div data-html-block="hero"></div>
                <div class="container" data-html-block="content">
                
<div class="page-container" id="page-user/en/guides/app-development/how-to-improve-a-standard-control" data-path="{{ pathname }}"
	>
	<div class="row ">
		
		<div class=" page-content col-sm-12 ">
			<div class="page-content-wrapper">
				<div class="row page-head">
					<div class='col-sm-12 hidden-xs'>
						
						<div class="page-breadcrumbs">
							
							
<ul class="breadcrumb" itemscope itemtype="http://data-vocabulary.org/Breadcrumb">
	
		<li>
			<a href="https://frappe.github.io/frappe//user/en/guides/app-development" itemprop="url">
			<span itemprop="title">App Development</span>
			</a>
		</li>
	
	<li class="active"><span itemprop="title">How To Improve A Standard Control</span></li>
</ul>

							
						</div>
						
					</div>
					<div class="col-sm-8 col-xs-6">
						<h1>How To Improve A Standard Control</h1>
					</div>
					<div class="col-sm-4 col-xs-6">
						

						
					</div>
				</div>
			</div>
			<div class="page_content">
<p>Frappé has a couple of elegant and useful widgets, but some times we need to edit them to add small improvements. This small article will describe how to add new resources to the standard widgets.</p>

<p>Let me explain first our goal:</p>

<p>&gt; Add <code>many</code> alternative translations in <code>numerous records</code> and in a <code>lot of doctypes</code></p>

<p>Look the highlighted sections in the <strong>goal</strong>, we have <em>many translations</em> to add in <em>many records</em> and in <em>many doctypes</em>, so, we heave a <strong>many of work</strong>, so we have a lot to do right?</p>

<p>The answer for this question is: <em>-Of course not! Because we know that if one element exists in many records and in many doctypes, this element is the <code>Control</code> or <code>Widget</code></em></p>

<p>So, what we need do, is improve your goal based on the <code>Control</code>, to reduce our quantity of work.</p>

<p>But, where will we find this magic element, the control? <em>-For now, we can look it in the JavaScript sources - let's look now at <a href="https://github.com/frappe/frappe/blob/develop/frappe/public/js/frappe/form/control.js#L13">Github</a></em></p>

<p>&gt; Don't worry if you don't understand the code for now, our goal there is simplify our work.</p>

<p>Let's go ahead with the thought!</p>

<p>We know where we need to make the changes, but how will we dismember which are the controls that are affected by our feature and which aren't ?</p>

<p>We need to keep in mind, that <code>Control</code> are instance of <code>DocFields</code> and the <code>DocFields</code> have a field that is very important for us in this case, the field that will help us to dismember which are affected by our feature and which aren't is the field <code>options</code> in the <code>DocField</code>.</p>

<p><em>-Wait!, we understood that the field <code>options</code> can help us, but, how will it help us?</em> </p>

<p>Good question, we will define a word to put in the <code>options</code> of the <code>DocFields</code> that we need to include the feature, this world will be <strong><code>Translatable</code>.</strong></p>

<p>&gt; If you forget how to customize the options of a field look <a href="https://kb.erpnext.com/kb/customize/creating-custom-link-field">this article</a>, it can refresh your knowledge.</p>

<p>Well, with the defined word in <code>options</code> of our selected <code>DocFields</code>, now is time to code:</p>

<p><em>-At last, we think we would never stop talking!</em></p>

<pre><code>frappe.ui.form.ControlData = frappe.ui.form.ControlData.$extend({
    make_input: function(){
        var options = this.df.options;
        if (!options || options!=="Translatable"){
            this._super();
            return;
        }
        var me = this;
        $('&lt;div class="link-field" style="position: relative;"&gt;\
            &lt;input type="text" class="input-with-feedback form-control"&gt;\
            &lt;span class="dialog-btn"&gt;\
                &lt;a class="btn-open no-decoration" title="' + __(" open="" translation")="" +="" '"=""&gt;\
                &lt;i class="fa fa-globe"&gt;&lt;/i&gt;&lt;/a&gt;\
            &lt;/span&gt;\
        &lt;/div&gt;').prependTo(this.input_area);
        this.$input_area = $(this.input_area);
        this.$input = this.$input_area.find('input');
        this.$btn = this.$input_area.find('.dialog-btn');
        this.set_input_attributes();
        this.$input.on("focus", function(){
            me.$btn.toggle(true);
        });
        this.$input.on("blur", function(){
            setTimeout(function(){ me.$btn.toggle(false) }, 500);
        });
        this.input = $this.input.get(0);
        this.has_input = true;
        var me = this;
        this.setup_button();
    },
    setup_button: function(){
        var me = this;
        if (this.only_input){
            this.$btn.remove();
            return;
        }
        this.$btn.on("click", function(){
            var value = me.get_value();
            var options = me.df.options;
            if (value &amp;amp;&amp;amp; options &amp;amp;&amp;amp; options==="Translatable"){
                this.open_dialog();
            }
        });
    },
    open_dialog: function(){
        var doc = this.doc;
        if (!doc.__unsaved){
            new frappe.ui.form.TranslationSelector({
                doc: doc,
                df: this.doc,
                text: this.value
            });
        }
    }
});
</code></pre>

<p><em>-Other letter soup, for my gosh!</em></p>

<p>In fact, it IS a soup of letters, for a newbie, but we are not a beginner.</p>

<p>Let me explain what this code does;</p>

<ul>
<li>At line 1 the code overrides the <code>ControlData</code> by one extended <code>Class</code> of itself.</li>
<li>The method <code>make_input</code> checks if the docfield is <strong><code>Translatable</code></strong> to make the new <code>Control</code> if not, it calls the <em>original</em> <code>make_input</code> using <code>_super()</code></li>
<li>The method <code>setup_button</code> checks if the docfield is <strong><code>Translatable</code></strong> to enable it show a <code>dialog</code></li>
<li>The method <code>open_dialog</code> invokes a new instance of the <code>TranslationSelector</code> that we will create in the code below.</li>
</ul>

<!-- markdown -->

</div>
		</div>
	</div>
</div>

				
<div class="page-container">
	<div class="page-content">
	<div class="edit-container text-center">
		<i class="fa fa-smile"></i>
		<a class="text-muted edit" href="https://github.com/frappe/frappe/blob/develop/frappe/docs/user/en/guides/app-development/how-to-improve-a-standard-control.md">
			Improve this page
		</a>
	</div>
	</div>
</div>
                </div>
            </div>
			<footer class="docs-footer">
				<div class="container"><div class="built-with-frappe text-center">
                    <img class="frappe-bird" src="https://frappe.github.io/frappe/assets/img/frappe-bird-grey.svg">
                    <h3>By Frappe Technologies</h3>
                </div>
                <div class="text-center">
                    <ul class="list-unstyled">
                        <li>
                            <a href="https://github.com/frappe/frappe">
                            Source</a>
                        </li>
                        <li>
                            <a href="https://github.com/frappe/frappe/issues">
                            Issues</a>
                        </li>
                        <li>
                            <a href="https://frappe.github.io/frappe/license.html">
                            License</a>
                        </li>
                        <li>
                            <a href="https://discuss.erpnext.com">
                            Forum</a>
                        </li>
                        <li>
                            <a href="https://community.erpnext.com/apps">
                            Frappe Apps</a>
                        </li>
                    </ul>
                </div>

            </div>
			</footer>
		</div>
	</div>

	<script type="text/javascript" src="https://frappe.github.io/frappe/assets/js/jquery.min.js"></script>
	<script type="text/javascript" src="https://frappe.github.io/frappe/assets/js/bootstrap.min.js"></script>
	<script type="text/javascript" src="https://frappe.github.io/frappe/assets/js/highlight.pack.js"></script>
	<script type="text/javascript" src="https://frappe.github.io/frappe/assets/js/docs.js"></script>

	<!-- js should be loaded in body! -->
	<script>
        window.docs_base_url = "https://frappe.github.io/frappe";
    </script>

	
	<script>
	  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

	  ga('create', 'UA-8911157-23', 'auto');
	  ga('send', 'pageview');

	</script>
	
	<!-- csrf_token --></body>
</html>